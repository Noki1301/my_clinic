{% extends 'base.html' %} {% block title %}Admin Dashboard - MyClinic{%endblock%} {% block content %}
<div class="container-fluid px-4">
	<!-- Header Section -->
	<div class="row mb-4">
		<div class="col-12">
			<div class="glass-card p-4">
				<div class="d-flex justify-content-between align-items-center">
					<div>
						<h2
							class="fw-bold mb-1"
							style="
								background: var(--primary-gradient);
								-webkit-background-clip: text;
								-webkit-text-fill-color: transparent;
							"
						>
							<i class="bi bi-shield-check"></i> Boshqaruv Markazi
						</h2>
						<p class="text-muted mb-0">Tizimni boshqarish va monitoring</p>
					</div>
					<div class="badge-modern badge bg-dark">
						<i class="bi bi-person-badge"></i> Admin: {{ user.username }}
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Statistics Cards -->
	<div class="row mb-4">
		<div class="col-md-4 mb-3">
			<div class="stat-card stat-card-primary">
				<div
					class="d-flex justify-content-between align-items-center position-relative"
				>
					<div>
						<h6
							class="text-uppercase mb-2 opacity-75"
							style="font-size: 0.85rem"
						>
							Jami Shifokorlar
						</h6>
						<h2 class="display-3 fw-bold mb-0">{{ total_doctors }}</h2>
						<p class="mt-2 mb-0 opacity-75">
							<i class="bi bi-arrow-up"></i> Aktiv shifokorlar
						</p>
					</div>
					<div class="opacity-25">
						<i class="bi bi-heart-pulse-fill" style="font-size: 5rem"></i>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-4 mb-3">
			<div class="stat-card stat-card-success">
				<div
					class="d-flex justify-content-between align-items-center position-relative"
				>
					<div>
						<h6
							class="text-uppercase mb-2 opacity-75"
							style="font-size: 0.85rem"
						>
							Jami Bemorlar
						</h6>
						<h2 class="display-3 fw-bold mb-0">{{ total_patients }}</h2>
						<p class="mt-2 mb-0 opacity-75">
							<i class="bi bi-arrow-up"></i> Ro'yxatdan o'tgan
						</p>
					</div>
					<div class="opacity-25">
						<i class="bi bi-people-fill" style="font-size: 5rem"></i>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-4 mb-3">
			<div class="stat-card stat-card-warning">
				<div
					class="d-flex justify-content-between align-items-center position-relative"
				>
					<div>
						<h6
							class="text-uppercase mb-2 opacity-75"
							style="font-size: 0.85rem"
						>
							Jami Qabullar
						</h6>
						<h2 class="display-3 fw-bold mb-0">{{ total_appointments }}</h2>
						<p class="mt-2 mb-0 opacity-75">
							<i class="bi bi-arrow-up"></i> Barcha vaqt
						</p>
					</div>
					<div class="opacity-25">
						<i class="bi bi-calendar-check-fill" style="font-size: 5rem"></i>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Content Section -->
	<div class="row">
		<!-- Appointments Table -->
		<div class="col-lg-8 mb-4">
			<div class="glass-card p-0 overflow-hidden">
				<div class="p-4 border-bottom">
					<h5 class="fw-bold mb-0">
						<i class="bi bi-calendar-event"></i> Oxirgi Qabullar
					</h5>
				</div>
				<div class="table-responsive">
					<table class="table table-hover mb-0">
						<thead style="background: var(--primary-gradient); color: white">
							<tr>
								<th class="border-0">Bemor</th>
								<th class="border-0">Shifokor</th>
								<th class="border-0">Sana & Vaqt</th>
								<th class="border-0">Status</th>
								<th class="border-0 text-center">Amal</th>
							</tr>
						</thead>
						<tbody>
							{% for app in appointments %}
							<tr>
								<td class="align-middle">
									<div class="d-flex align-items-center">
										<div
											class="bg-primary bg-opacity-10 rounded-circle p-2 me-2"
										>
											<i class="bi bi-person-fill text-primary"></i>
										</div>
										<strong>{{ app.patient.username }}</strong>
									</div>
								</td>
								<td class="align-middle">
									<span class="text-muted">Dr. {{ app.doctor.last_name }}</span>
								</td>
								<td class="align-middle">
									<div>
										<i class="bi bi-calendar3"></i> {{ app.date|date:"d M, Y"
										}}<br />
										<small class="text-muted"
											><i class="bi bi-clock"></i> {{ app.time }}</small
										>
									</div>
								</td>
								<td class="align-middle">
									{% if app.status == 'pending' %}
									<span class="badge-modern badge-pending">
										<i class="bi bi-clock-history"></i> Kutilmoqda
									</span>
									{% elif app.status == 'confirmed' %}
									<span class="badge-modern badge-confirmed">
										<i class="bi bi-check-circle"></i> Tasdiqlandi
									</span>
									{% elif app.status == 'cancelled' %}
									<span class="badge-modern badge-cancelled">
										<i class="bi bi-x-circle"></i> Bekor qilindi
									</span>
									{% elif app.status == 'completed' %}
									<span class="badge-modern badge-completed">
										<i class="bi bi-check-all"></i> Yakunlandi
									</span>
									{% endif %}
								</td>
								<td class="align-middle text-center">
									<div class="btn-group btn-group-sm">
										<a
											href="{% url 'update_status' app.id 'confirmed' %}"
											class="btn btn-sm btn-outline-success"
											title="Tasdiqlash"
										>
											<i class="bi bi-check"></i>
										</a>
										<a
											href="{% url 'update_status' app.id 'completed' %}"
											class="btn btn-sm btn-outline-primary"
											title="Yakunlash"
										>
											<i class="bi bi-check-all"></i>
										</a>
										<a
											href="{% url 'delete_appointment' app.id %}"
											class="btn btn-sm btn-outline-danger"
											onclick="return confirm('Rostdan ham o\'chirmoqchimisiz?')"
											title="O'chirish"
										>
											<i class="bi bi-trash"></i>
										</a>
									</div>
								</td>
							</tr>
							{% empty %}
							<tr>
								<td colspan="5" class="text-center py-5 text-muted">
									<i class="bi bi-inbox display-1"></i>
									<p class="mt-3">Hozircha qabullar yo'q</p>
								</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<!-- Doctors List -->
		<div class="col-lg-4 mb-4">
			<div class="glass-card p-0 overflow-hidden">
				<div class="p-4 border-bottom">
					<h5 class="fw-bold mb-0"><i class="bi bi-people"></i> Shifokorlar</h5>
				</div>
				<div class="p-3" style="max-height: 600px; overflow-y: auto">
					{% for doctor in doctors %}
					<div
						class="d-flex align-items-center p-3 mb-2 rounded hover-card"
						style="background: #f8f9fa; transition: all 0.3s"
					>
						<div class="me-3">
							{% if doctor.image %}
							<img
								src="{{ doctor.image.url }}"
								class="rounded-circle"
								width="50"
								height="50"
								style="object-fit: cover"
							/>
							{% else %}
							<div
								class="rounded-circle bg-primary d-flex align-items-center justify-content-center"
								style="width: 50px; height: 50px"
							>
								<i class="bi bi-person-fill text-white fs-4"></i>
							</div>
							{% endif %}
						</div>
						<div class="flex-grow-1">
							<h6 class="mb-0 fw-bold">
								{{ doctor.first_name }} {{ doctor.last_name }}
							</h6>
							<small class="text-muted">{{ doctor.speciality }}</small>
						</div>
						<a
							href="{% url 'doctor_detail' doctor.id %}"
							class="btn btn-sm btn-outline-primary"
						>
							<i class="bi bi-eye"></i>
						</a>
					</div>
					{% empty %}
					<div class="text-center py-4 text-muted">
						<i class="bi bi-person-x display-3"></i>
						<p class="mt-2">Shifokorlar topilmadi</p>
					</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>

	<!-- Quick Actions -->
	<div class="row mt-4">
		<div class="col-12">
			<div class="glass-card p-4">
				<h5 class="fw-bold mb-3">
					<i class="bi bi-lightning-fill"></i> Tezkor Harakatlar
				</h5>
				<div class="d-flex gap-3 flex-wrap">
					<a href="/admin/" class="btn btn-gradient-primary">
						<i class="bi bi-gear"></i> Django Admin
					</a>
					<a href="{% url 'home' %}" class="btn btn-gradient-success">
						<i class="bi bi-house-door"></i> Bosh Sahifa
					</a>
					<button class="btn btn-outline-primary" onclick="window.print()">
						<i class="bi bi-printer"></i> Chop etish
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<style>
	.hover-card:hover {
		background: white !important;
		transform: translateX(5px);
		box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
	}
</style>
{% endblock %}
